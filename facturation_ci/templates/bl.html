<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
        --primary: #0f766e;
        --primary-dark: #0f766e;
        --white: #FFFFFF;
        --gray-100: #F3F4F6;
        --gray-200: #E5E7EB;
        --gray-300: #D1D5DB;
        --gray-500: #6B7280;
        --gray-600: #4B5563;
        --gray-700: #374151;
        --gray-800: #1F2937;
    }
    body { font-family: 'Inter', sans-serif; padding: 40px; }
    h1 { color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 6px; }
    h3 { font-size: 12px; text-transform: uppercase; color: var(--gray-600); margin-bottom: 8px; }
    table { width:100%; border-collapse: collapse; margin-top:20px }
    th, td { border-bottom:1px solid #ddd; padding:8px }
    th { background:#f6f8fb; text-align:left; font-size:13px; color:#6b7280 }
    .details-container { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin: 20px 0 30px; }
    .detail-box { font-size: 13px; }
    .company-name, .client-name { font-weight: 600; }
    .fne-panel { border: 1px solid var(--primary); border-radius: 8px; padding: 10px; text-align: center; background-color: #f0fdfa; }
    .fne-panel h3 { font-size: 11px; color: var(--primary-dark); margin-bottom: 5px; }
    .fne-logo { max-width: 60px; margin-bottom: 5px; }
    .fne-qr-code { max-width: 80px; }
  </style>
</head>
<body>
  <h1>Bon de Livraison</h1>

  <div class="details-container">
      <div class="detail-box">
          <h3>Expéditeur</h3>
          <div class="company-name">{{ company.name }}</div>
          <div>{{ company.address | replace('\n', '<br>') | safe }}</div>
          <div>{{ company.contact }}</div>
      </div>
      <div class="detail-box">
          <h3>Destinataire</h3>
          <div class="client-name">{{ client.name }}</div>
          <div>{{ client.address | replace('\n', '<br>') | safe }}</div>
          <div>{{ client.contact }}</div>
      </div>
      <div class="detail-box">
          <h3>Informations</h3>
          <div><strong>#{{ invoice.code_bl }}</strong></div>
          <div>Date: {{ invoice.bl_date_creation.strftime('%d-%m-%Y') }}</div>
          <div>Facture: {{ invoice.code_facture }}</div>
          {% if qr_code_uri %}
          <div class="fne-panel" style="margin-top:10px;">
              <h3>BL Nº {{ invoice.fne_nim }}</h3>
              <img src="{{ fne_logo_uri }}" alt="Logo FNE" class="fne-logo">
              <img src="{{ qr_code_uri }}" alt="QR Code FNE" class="fne-qr-code">
          </div>
          {% endif %}
      </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Produit / Service</th>
        <th>Qté</th>
      </tr>
    </thead>
    <tbody>
      {% for item in details %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ item.description }}</td>
        <td style="text-align:center">{{ item.qty }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div style="margin-top:50px; font-size:12px; color:#6b7280">
    Ce document atteste de la livraison des biens ou services listés ci-dessus.
  </div>
</body>
</html>
